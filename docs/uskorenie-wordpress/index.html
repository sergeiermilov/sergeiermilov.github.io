<!doctype html>
<html lang="ru">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="apple-touch-icon" sizes="180x180" href="../../assets/icons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../../assets/icons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../../assets/icons/favicon-16x16.png">
	<link rel="manifest" href="../../assets/icons/site.webmanifest">
	<link rel="mask-icon" href="../../assets/icons/safari-pinned-tab.svg" color="#787878">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="theme-color" content="#ffffff">

  	<!-- Bootstrap CSS -->
  	<link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="../../assets/css/prism.css">
	<link rel="stylesheet" href="../../assets/css/style.css">

    <title>Ускорение и оптимизация WordPress &#8212; SergeiErmilov</title>
  </head>
<body class="position-relative">
	<!-- Yandex.Metrika counter -->
	<script type="text/javascript">
		(function(m,e,t,r,i,k,a){
			m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
			m[i].l=1*new Date();
			for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
			k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
		})(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=104047655', 'ym');

		ym(104047655, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
	</script>
	<noscript><div><img src="https://mc.yandex.ru/watch/104047655" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
	<!-- /Yandex.Metrika counter -->   

<!-- navbar section -->
<section class="navbar-section">
	<nav class="navbar navbar-expand-lg navbar-light bg-white">
		<div class="container">
			<a class="navbar-brand d-flex gap-3 align-items-center" href="../../">
				<img src="../../assets/images/sergei-150.png" alt="" width="80" height="80" class="d-inline-block align-middle">
				<div class="logo-block"><span class="fw-bold">Фронтенд</span><br><span class="small-font">Сергей Ермилов</span></div>
			</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav ms-0 ms-md-5 mb-2 mb-lg-0">

					<li class="nav-item">
						<a class="nav-link" title="GitHub" target="_blank" href="https://github.com/uzabila"><img src="../../assets/images/gh.svg" alt="GitHub" width="32" height="32" class="mx-3" style="margin-top:-5px"></a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../../about/">Обо мне</a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../../services/">Услуги</a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../../portfolio/">Портфолио</a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../../docs/">Доки</a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../../terms/">Термины</a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../../tools/">Инструменты</a>
					</li>
					
					<li class="nav-item">
						<a class="nav-link" href="../../book/">Книга</a>
					</li>
		
					<li class="nav-item">
						<a class="nav-link" href="../../contacts/">Контакты</a>
					</li>
			</div>
		</div>
	</nav>
</section>
<!-- ---------- --> 
<!-- END HEADER -->
<!-- ---------- -->

<div class="container">
	<div class="row mb-3 mb-md-4 mb-lg-5">
		<div class="col-12 single-content-column">
			<p><a href="../" class="link-secondary">Доки</a></p>
			<h1 class="fw-600">Ускорение и оптимизация WordPress</h1>

<p>В этом руководстве я собираю все основные советы и рекомендации по ускорению и оптимизации WordPress сайтов.</p>

<p>Руководство затрагивает два больших понятия — ускорение и оптимизация WordPress сайтов. Материал будет постоянно дополняться и обновляться по мере сил и возможностей. Нужно также понимать, что не все способы нужно использовать, а некоторые способы ускорения могут помешать другим методам, поэтому в выборе нужных решений лучше консультироваться со специалистами.</p>

<p>Стоит сказать , что здесь мы рассмотрим вопросы именно внутренней оптимизации сайтов и их правильной функциональности, т.е. постараемся сделать так, чтобы поисковые системы лучше относились к сайту.</p>

<h2><span id="1_Udalaem_neispolzuemye_plaginy">1. Удаляем неиспользуемые плагины</span></h2>

<p>Оптимизация WordPress начинается с самого простого и очевидного шага — убираем всё лишнее.</p>

<p>Поэтому сначала мы удаляем из WordPress все неиспользуемые плагины. Кроме того, есть много работающих плагинов, но которые не несут никакой полезной нагрузки.</p>

<h2><span id="2_Perehodim_na_Cloudflare">2. Переходим на Cloudflare </span></h2>

<p>Рекомендую начать использовать Cloudflare в формате CDN и переключить DNS-провайдера на Cloudflare.</p>

<h2><span id="3_Ustanovka_plagina_kesirovania">3. Установка плагина кэширования</span></h2>

<p>Для многих оптимизация WordPress начинается и заканчивается с установки плагина кеширования. Среди которых одними из самых популярных являются WP Rocket, WP Super Cache, W3 Total Cache.</p>

<p>Установка плагина кэширования рекомендуется почти всеми, но стоит понимать, что мы не всегда получим тот результат, который ожидали.</p>

<h2><span id="4_Minimiziruem_kod">4. Минимизируем код</span></h2>

<p>Минификация удаляет пробелы и комментарии из кода, чтобы уменьшить размер файла. А файлы меньшего размера сокращают время загрузки. Это относится к HTML и CSS.</p>

<h2><span id="5_Obedinenie_JavaScript_i_CSS_fajlov">5. Объединение  JavaScript и CSS файлов</span></h2>

<p>Большинство сайтов WordPress содержат множество файлов CSS и JavaScripts. Некоторые из них предназначены для тем, другие — для плагинов, и, возможно, у вас также есть несколько пользовательских файлов.</p>

<p>Объединение этих файлов может ускорить работу, но это зависит от настроек вашего сервера.</p>

<ul>
<li>При <strong>HTTP/1.1</strong> файлы CSS и JavaScript загружаются последовательно. Это означает, что один файл должен полностью загрузиться, прежде чем начнется загрузка следующего.</li>



<li>В <strong>HTTP/2</strong> файлы загружаются параллельно. Это означает, что несколько файлов CSS и JavaScript могут загружаться одновременно.</li>
</ul>



<p>Если ваш сервер использует <strong>HTTP/1.1</strong>, объединение файлов ускоряет работу, поскольку требуется загрузить меньшее количество файлов. Если он использует <strong>HTTP/2</strong>, объединение файлов не будет иметь большого значения, поскольку файлы все равно могут загружаться одновременно.</p>



<p>Чтобы узнать, какую версию использует ваш сайт, используйте Key CDN Tester. Если HTTP/2 не поддерживается, стоит объединить файлы CSS и JavaScript.</p>



<h2><span id="6_Ustranenie_resursov_blokiruusih_rendering">6. Устранение ресурсов, блокирующих рендеринг</span></h2>



<p>Кто проверял свои сайты в сервисе Google Pagespeed тот уже видел рекомендации «Eliminate render-blocking resources».</p>


<div>
<figure><img src="images/pagespeed-insights.png" alt="" class="img-fluid"></figure></div>


<p>Рендеринг — это процесс превращения кода в видимую веб-страницу.</p>



<p>Ключевым словом здесь является «видимая», поскольку веб-страница не всегда должна полностью загрузиться, прежде чем ее можно будет увидеть.</p>



<p>По этой причине имеет смысл отдавать приоритет загрузке ресурсов для контента, находящегося в верхней части страницы.</p>



<p>Вы можете сделать это, отложив загрузку некритичных файлов CSS и JavaScript, необходимых для содержимого «в нижней части страницы», на более позднее время.</p>



<h2><span id="7_Lenivaa_zagruzka_izobrazenij_i_video">7. Ленивая загрузка изображений и видео</span></h2>



<p>Ленивая загрузка повышает скорость страницы, откладывая загрузку изображений и видео до тех пор, пока они не будут видны на экране. Если вы используете <strong>WordPress 5.5+</strong>, ленивая загрузка изображений включена по умолчанию, но не для видео.</p>



<p>Для решения этой задачи есть множество плагинов.</p>



<h2><span id="8_Optimizacia_sriftov_Google">8. Оптимизация шрифтов Google</span></h2>



<p>Многие темы используют шрифты Google Fonts, и эти шрифты скорее всего (не всегда) загружаются с сервера Google каждый раз, когда кто-то посещает ваш сайт. Это может занять много времени, поскольку серверу приходится выполнять HTTP-запросы, загружать файл CSS, а затем загружать шрифт из места, указанного в таблице стилей. И это нужно сделать для каждого шрифта на странице.</p>



<h2><span id="9_Vklucenie_predvaritelnoj_zagruzki">9. Включение предварительной загрузки</span></h2>



<p>Предварительная загрузка позволяет определить основные ресурсы, чтобы браузеры знали приоритет файлов для загрузки.</p>



<p>Например, предположим, что ваш код выглядит следующим образом:</p>



<pre><code class="language-html">&lt;html&gt; 
&lt;head&gt; 
&lt;script type=”text/javascript” src=”somefile.js”&gt;&lt;/script&gt;
&lt;link rel=”stylesheet” href=”/style.css”&gt;
&lt;/head&gt;
&lt;body&gt;
Content
&lt;/body&gt;
&lt;/html&gt;</code></pre>



<p>Исходя из этого кода, файл JavaScript должен загружаться первым из-за иерархии. Это не идеально, потому что файл CSS почти наверняка более важен, чем код JavaScript.</p>



<p>Самый простой способ решить эту проблему — добавить еще одну строку кода, например, такую:</p>



<pre><code class="language-html">&lt;link rel="preload" href="/style.css" as="style"&gt;</code></pre>



<p>Это указывает браузерам на приоритет файла CSS над файлом JavaScript, независимо от иерархии.</p>



<p>Вы можете добавить атрибуты предзагрузки вручную, отредактировав код, но это может привести к беспорядку и путанице, если вы не знаете, что делаете.</p>



<h2><span id="10_Podklucaem_CDN">10. Подключаем CDN</span></h2>



<p><strong>CDN</strong> (Content Delivery Network)&nbsp;— это географически распределённая сетевая инфраструктура, обеспечивающая быструю доставку контента пользователям сайтов.</p>



<p>Сети доставки контента (CDN) — это группы серверов, распределенных по всему миру. Каждый из них хранит копию вашего сайта, чтобы пользователи могли быстрее подключаться к нему при запросе веб-страниц.</p>



<p>Допустим, сервер вашего хостера находится в Великобритании. Если кто-то посещает ваш сайт из США, а вы не используете CDN, соединение между его устройством и вашим сервером будет медленным. Если кто-то заходит на сайт из США, а вы используете CDN, его устройство подключится к ближайшему серверу в США, что сократит расстояние доставки контента и ускорит соединение.</p>



<p>Кстати, после подключения CDN для большого количества сайтов оптимизация WordPress может быть завершена. Скорость работы сайта будет в разы выше, что отлично влияет на отношение к сайту поисковиков.</p>



<h2><span id="11_Otklucaem_plagin_Query_Monitor_dla_kirillicy">11. Отключаем плагин Query Monitor для кириллицы</span></h2>



<p>Как бы это странно не звучало — для русскоязычных сайтов лучше отключить плагин Query Monitor, который, казалось бы, должен служить оптимизации WordPress.</p>



<p>К сожалению, было замечено замедление сайтов на WordPress при использовании данного плагина.</p>



<h2><span id="12_Optimiziruem_izobrazenia">12. Оптимизируем изображения</span></h2>



<p>Ленивая загрузка решает многие проблемы, связанные с изображениями, но она ничего не делает для изображений, загружаемых в верхней части страницы. Чем они больше, тем сильнее они влияют на время загрузки.</p>



<p>Чтобы решить эту проблему, необходимо сжать изображения. Это может быть реализовано с помощью многих плагинов.</p>



<h2><span id="13_Svezaa_versia_WordPress">13. Свежая версия WordPress</span></h2>



<p>Создатели WordPress постоянно работают над улучшением своей Системы Управления. Новые версии CMS имеют лучшую производительность и оптимизированный код.</p>


<div>
<figure><img src="images/wordpress-5-zaprosi-php.jpg" alt="" class="img-fluid"></figure></div>


<h2><span id="14_Novaa_versia_PHP">14. Новая версия PHP</span></h2>



<p>WordPress в основном написан на языке программирования PHP. Это язык на стороне сервера, что означает, что он устанавливается и работает на вашем хостинг-сервере.</p>



<p>Все хорошие хостинг-компании WordPress используют на своих серверах самую стабильную версию PHP. Однако возможно, что ваша хостинг-компания использует более старую версию PHP.</p>



<p>Новая версия PHP 7 в два раза быстрее своих предшественников. Это огромный прирост производительности, которым должен воспользоваться ваш сайт.</p>



<p>Если на вашем сайте используется версия ниже PHP 7, попросите хостинг-провайдера обновить ее для вас.</p>



<h2><span id="15_Optimizacia_fonovyh_processov">15. Оптимизация фоновых процессов</span></h2>



<p>Фоновые процессы в WordPress — это запланированные задачи, которые выполняются в фоновом режиме на вашем сайте. Ниже приведены примеры фоновых задач, которые могут выполняться:</p>



<ul>
<li>Задачи плагина резервного копирования WordPress</li>



<li>Задания крона WordPress для публикации запланированных постов</li>



<li>Задания крона WordPress для проверки обновлений</li>



<li>Поисковые системы и другие краулеры и сканеры, которые пытаются получить контент</li>
</ul>



<p>Вы должны убедиться, что все это работает только в период низкой посещаемости вашего сайта.</p>



<h2><span id="16_Ispolzujte_otryvki_excerpts_na_glavnoj_i_v_arhivah">16. Используйте отрывки (excerpts) на главной и в архивах</span></h2>



<p>Или не используйте вообще. Отрывки зачастую не нужны, достаточно хорошего заголовка. Если мы убираем вызов функции <strong><em>the_excerpt</em></strong>, то прилично сокращаем количество обращений к Базе Данных MySQL.</p>



<p>К тому же, судя по замерам, эта функция очень медленная.</p>



<h2><span id="17_Razdelaem_kommentarii_po_stranicam">17. Разделяем комментарии по страницам</span></h2>



<p>WordPress поставляется со встроенным решением для этого. Просто перейдите в <strong>Настройки</strong> -&gt; <strong>Обсуждения</strong> (<strong>Settings -&gt; Discussion</strong>&nbsp;) и установите флажок напротив опции «<em>Разбивать комментарии на страницы</em>» (Break comments into pages).</p>


<div>
<figure><img src="images/breakcomments.png" alt="" class="img-fluid"></figure></div>


<h2><span id="18_Ne_zagruzaem_audiovideo_neposredstvenno_v_WordPress">18. Не загружаем аудио/видео непосредственно в WordPress</span></h2>



<p>Вы можете напрямую загружать аудио- и видеофайлы на свой сайт WordPress, и он будет автоматически отображать их в HTML5-плеере.</p>



<p>Но вы НИКОГДА не должны этого делать!</p>



<p>Вместо этого вам следует воспользоваться услугами аудио- и видеохостинга, такими как YouTube, Vimeo, DailyMotion, SoundCloud и т.д., и позволить им взять на себя всю тяжелую работу. У них есть для этого необходимые ресурсы.</p>



<p>В WordPress есть встроенная функция вставки видео, поэтому вы можете скопировать и вставить URL вашего видео прямо в запись, и оно автоматически встроится.</p>



<h2><span id="19_Ispolzovanie_optimizirovannoj_temy">19. Использование оптимизированной темы</span></h2>



<p>При выборе темы для вашего сайта важно уделить особое внимание оптимизации скорости. Некоторые красивые и эффектно выглядящие темы на самом деле плохо запрограммированы и могут замедлить работу вашего сайта.</p>



<p>Обычно лучше выбрать более простую тему, чем тему, раздутую сложными макетами, яркой анимацией и другими ненужными функциями. Вы всегда можете добавить эти функции с помощью качественных плагинов WordPress или с помощью профессиональных разработчиков.</p>



<h2><span id="20_Ispolzovanie_bystryh_plaginov">20. Использование быстрых плагинов</span></h2>



<p>Плагины WordPress с плохим кодом часто загружают слишком много лишнего, независимо от того, нужно это вашему сайту или нет. Это увеличивает скорость загрузки страницы и замедляет работу сайта. Пример выше с Query Monitor как раз об этом.</p>



<div class="attention-yellow"><strong>Внимание</strong>! Количество плагинов не так важно, как их качество!</div>



<p>Одна большая проблема с плагинами WordPress — это процесс деинсталляции. Каждый раз, когда вы устанавливаете плагин или тему WordPress, он сохраняет свои данные в базе данных.</p>



<p>Проблема в том, что когда вы удаляете плагин одним из стандартных методов, он обычно оставляет после себя все эти таблицы и строки в базе данных. Со временем это может привести к накоплению большого количества данных и даже к замедлению работы сайта. Например, плагин безопасности <strong>Wordfence</strong> оставил после себя 24 таблицы в базе данных. Но самое страшное, если данные остались в таблице <code>wp_options</code>.</p>



<h2><span id="21_Razdelaem_dlinnye_stati_na_stranicy">21. Разделяем длинные статьи на страницы</span></h2>



<p>Читателям нравятся более длинные и подробные статьи. Более длинные посты даже имеют тенденцию занимать более высокие позиции в поисковых системах.</p>



<p>Но если вы публикуете длинные статьи с большим количеством изображений, это может ухудшить время загрузки.</p>



<p>Вместо этого подумайте о том, чтобы разделить длинные посты на несколько страниц.</p>



<p>WordPress имеет встроенную функцию для этого. Просто добавьте тег <code>&lt;!--nextpage--&gt;</code> в статью, где вы хотите разделить ее на еще одну страницу. Сделайте это еще раз, если хотите разделить статью и на еще одну страницу, хоть после каждого предложения.</p>



<p>Кроме базы данных, многие плагины также оставляют после себя дополнительные папки и файлы.</p>



<h2><span id="22_Sokrasaem_vnesnie_HTTP-zaprosy">22. Сокращаем внешние HTTP-запросы</span></h2>



<p>Многие плагины и темы WordPress загружают всевозможные файлы с других сайтов. Эти файлы могут включать скрипты, таблицы стилей и изображения с внешних ресурсов, таких как Google, Facebook, сервисы аналитики и так далее.</p>



<p>Вполне нормально использовать несколько из них. Многие из этих файлов оптимизированы для максимально быстрой загрузки, поэтому это быстрее, чем размещать их на собственном сайте.</p>



<p>Но если ваши плагины делают много таких запросов, то это может значительно замедлить работу вашего сайта.</p>



<p>Вы можете уменьшить количество внешних HTTP-запросов, отключив скрипты и стили или объединив их в один файл.</p>



<p>Использование внешних скриптов на веб-страницах увеличивает общее время загрузки сайта. Поэтому лучше всего использовать небольшое количество скриптов, включая только самые необходимые, такие как инструменты отслеживания (например, Google Analytics) или системы комментирования (например, Disqus).</p>



<h2><span id="23_Umensenie_obrasenij_k_baze_dannyh">23. Уменьшение обращений к базе данных</span></h2>



<p>Этот шаг является немного более техническим и требует базовых знаний PHP и файлов шаблонов WordPress.</p>



<p>К сожалению, существует множество плохо проработанных тем WordPress. Они игнорируют стандартную практику WordPress и в итоге делают прямые вызовы базы данных или слишком много ненужных запросов к базе данных. Это может замедлить работу вашего сервера, так как на него ложится слишком много работы.</p>



<p>Даже хорошо проработанные темы могут содержать код, который делает вызовы к базе данных только для того, чтобы получить основную информацию о вашем блоге.</p>



<p>В этом примере каждый раз, когда вы видите <code>&lt;?php</code>, это начало нового вызова базы данных:</p>



<pre><code class="language-html">&lt;html xmlns="http://www.w3.org/1999/xhtml" dir="&lt;?php language_attributes(); ?&gt;"&gt;
&lt;head profile="http://gmpg.org/xfn/11"&gt;
&lt;meta http-equiv="Content-Type" content="&lt;?php bloginfo('html_type'); ?&gt; 
charset=&lt;?php bloginfo('charset'); ?&gt;" /&gt;</code></pre>



<p>В этом конкретном случае нельзя сильно винить разработчиков темы. У них просто нет другого способа узнать, на каком языке будет работать ваш сайт.</p>



<p>Но если вы настраиваете свой сайт с помощью дочерней темы, то вы можете заменить эти вызовы базы данных на конкретную информацию, чтобы сократить все эти вызовы базы данных.</p>



<pre><code class="language-html">&lt;html xmlns="http://www.w3.org/1999/xhtml" dir="ltr"&gt;
&lt;head profile="http://gmpg.org/xfn/11"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;</code></pre>



<p>Просмотрите свою родительскую тему на предмет подобных случаев, которые можно легко заменить статичной информацией.</p>



<h2><span id="24_Optimizacia_bazy_dannyh_WordPress">24. Оптимизация базы данных WordPress</span></h2>



<p>После использования WordPress в течение некоторого времени в вашей базе данных будет много информации, которая, вероятно, больше не нужна. Для повышения производительности вы можете оптимизировать свою базу данных, чтобы избавиться от ненужной информации.</p>



<p>Это можно легко сделать с помощью плагина типа WP-Optimize. Он позволяет очистить базу данных WordPress, удалив удаленные посты, ревизии, неиспользуемые теги и т.д. Он также оптимизирует структуру вашей базы данных.</p>



<h2><span id="25_Ogranicenie_kolicestva_revizij_postov">25. Ограничение количества ревизий постов</span></h2>



<p>Ревизии постов занимают место в базе данных WordPress. Некоторые пользователи считают, что ревизии также могут влиять на некоторые запросы к базе данных, выполняемые плагинами. Если плагин специально не исключает ревизии постов, он может замедлить работу вашего сайта, перебирая их без необходимости.</p>



<p>Вы можете легко ограничить количество ревизий, которые WordPress хранит для каждой статьи. Просто добавьте эту строку кода в файл <strong><em>wp-config.php</em></strong>.</p>



<pre><code class="language-php">define( 'WP_POST_REVISIONS', 4 );</code></pre>



<p>Этот код ограничит WordPress сохранением только последних 4 редакций каждого поста или страницы, а более ранние редакции будут автоматически отбрасываться.</p>



<h2><span id="26_Otklucenie_hotlinkov_i_utecki_vasego_kontenta">26. Отключение хотлинков и утечки вашего контента</span></h2>



<p>Если вы создаете качественный контент на своем сайте WordPress, то печальная правда заключается в том, что рано или поздно он будет украден.</p>



<p>Это происходит в том случае, если другие сайты размещают ваши изображения непосредственно по их URL-адресам на вашем сайте, вместо того чтобы загружать их на свои собственные серверы. По сути, они крадут пропускную способность вашего хостинга, а вы не получаете за это никакого трафика.</p>



<p>Просто добавьте этот код в файл <em><strong>.htaccess</strong></em>, чтобы заблокировать горячие ссылки (хотлинки) на изображения с вашего сайта WordPress.</p>



<pre><code class="language-php">RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?yoursite.com [NC]
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?google.com [NC]
RewriteRule \.(jpg|jpeg|png|gif)$ – [NC,F,L]</code></pre>



<p>Не забудьте заменить <strong>yoursite.com</strong> на свой собственный домен.</p>



<h2><span id="27_Ispolzuem_brandmauer_veb-sajta_na_urovne_DNS">27. Используем брандмауэр веб-сайта на уровне DNS</span></h2>



<p>Плагин брандмауэра WordPress помогает блокировать атаки методом перебора, попытки взлома и вредоносное ПО. Однако не все плагины брандмауэра одинаковы.</p>



<p>Некоторые из них работают на вашем веб-сайте, это означает, что злоумышленники уже могут достичь вашего веб-сервера, прежде чем они будут заблокированы. Это по-прежнему эффективно для безопасности, но не оптимально для производительности.</p>



<p>Вот почему мы рекомендуем использовать брандмауэр уровня DNS, например Sucuri или Cloudflare. Эти брандмауэры блокируют нежелательные запросы еще до того, как они попадут на ваш сайт.</p>



<h2><span id="28_Ispravlenie_osibok_HTTPSSSL">28. Исправление ошибок HTTPS/SSL</span></h2>



<p>Если вы переводите свой сайт на HTTPS/SSL, то вполне вероятно, что вы можете столкнуться с ошибками смешанного контента.</p>



<p>Самый простой способ исправить это — установить плагин типа <strong>Really Simple SSL</strong>. Однако проблема в том, что эти плагины сначала перехватывают все URL-адреса, а затем изменяют их на HTTPS, прежде чем отправить их в браузеры пользователей.</p>



<p>Это оказывает небольшое, но заметное влияние на производительность. Вы можете уменьшить это влияние, вручную исправляя все URL-адреса.</p>



<h2><span id="29_Menaem_hosting-provajdera">29. Меняем хостинг-провайдера</span></h2>



<p>Очевидный факт, что некоторые хостинг-компании не сильно заботятся о своих клиентов и не занимаются оптимизацией своих серверов под WordPress. </p>



<p>Лучше всего подбирать себе хостинг по отзывам и из тех, кто знаком с WordPress.</p>



<div class="attention-yellow"><strong>Внимание</strong>! Выбираем хостинг, использующий Nginx.</div>



<p>Каждый хостинг WordPress использует веб-сервер для обеспечения работы ваших сайтов WordPress. Наиболее распространенными вариантами являются Nginx и Apache.</p>



<p>Настоятельно рекомендую выбирать хостинг, использующий <strong>Nginx</strong>, поскольку он основан на оптимизации производительности при масштабировании. Nginx часто превосходит другие популярные веб-серверы в эталонных тестах, особенно в ситуациях со статическим контентом или большим количеством одновременных запросов.</p>



<h2><span id="30_Vklucit_szatie_GZIP">30. Включить сжатие GZIP</span></h2>



<p>Сжатие файлов на локальном компьютере может сэкономить много дискового пространства. Аналогично, в Интернете мы можем использовать сжатие GZIP. Этот маневр значительно сократит использование полосы пропускания и время, необходимое для получения доступа к вашему сайту.</p>



<p>GZIP сжимает различные файлы таким образом, что каждый раз, когда посетитель пытается зайти на ваш сайт, его браузеру сначала приходится разархивировать сайт. Этот процесс значительно снижает использование полосы пропускания.</p>



<p>Вы можете использовать либо плагин, который включает GZIP-сжатие, либо добавить следующий код в файл <strong><em>.htaccess</em></strong>.</p>



<pre><code class="language-php">AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript</code></pre>



<h2><span id="31_Otklucenie_pingbekov_i_trekbekov">31. Отключение пингбеков и трекбэков</span></h2>



<p>Пингбэки и трекбэки — это два основных компонента WordPress, которые предупреждают вас, когда ваш блог или страница получает ссылку. Это может показаться полезным, но у вас также есть такие вещи, как Инструменты Google для веб-мастеров и другие службы, чтобы проверять ссылки на вашем веб-сайте.</p>



<p>Сохранение пингбэков и трекбэков также может создать нежелательную нагрузку на ресурсы вашего сервера. Это потому, что всякий раз, когда кто-то пытается установить ссылку на ваш сайт, он генерирует запросы от WordPress туда и обратно. Этой функцией также часто злоупотребляют при нацеливании на веб-сайт с помощью DDoS-атак.</p>



<p>Вы можете отключить все это в <strong>Настройки</strong> → <strong>Обсуждение</strong> (<em>Settings → Discussion</em>). Просто снимите флажок «Разрешить уведомления о ссылках из других блогов (пингбэки и трекбэки)» (<em>Allow link notifications from other blogs (pingbacks and trackbacks)</em>). Это поможет вам еще немного ускорить работу WordPress.</p>



<h2><span id="32_Pereezzaem_na_VPS">32. Переезжаем на VPS</span></h2>



<p>Виртуальный сервер, <strong>VPS</strong> (англ. virtual private server) или <strong>VDS</strong> (англ. virtual dedicated server) — это хостинг, который имитирует выделенный сервер. На одном физическом носителе работает сразу несколько виртуальных серверов, но они изолированы друг от друга.</p>



<p>Обычно VPS-хостинг покупают, когда возможностей виртуального хостинга недостаточно, а ресурсов целого сервера — слишком много.</p>



<p>Но чтобы переехать на VPS нужно либо иметь набор определенных знаний в области администрирования серверов либо заказывать услугу администрирования у хостинг-провайдера, предоставляющего сервер. Также нужно понимать, что услуга выделенного сервера стоит дороже виртуального хостинга.</p>



<h2><span id="33_Ispolzovanie_HTTP2">33. Использование HTTP/2</span></h2>



<p>HTTP/2 — это веб-протокол, выпущенный в 2015 году, который был разработан для ускорения доставки веб-сайтов. Из-за поддержки браузерами он требует HTTPS (SSL). Если ваш хостинг WordPress не поддерживает HTTP/2, вам следует начать поиск нового провайдера. С переходом всего интернета на HTTPS это уже не просто приятная функция, это необходимость.</p>



<p>Улучшение производительности с HTTP/2 обусловлено целым рядом причин, таких как поддержка лучшего мультиплексирования, параллелизм, сжатие HPACK с кодировкой Хаффмана, расширение ALPN и push сервера. Раньше при работе по HTTPS возникало довольно много накладных расходов на TLS, но теперь их стало гораздо меньше благодаря HTTP/2 и TLS 1.3.</p>



<p>Еще одна большая победа HTTP/2 заключается в том, что для большинства сайтов WordPress вам больше не нужно беспокоиться о конкатенации (объединении файлов) или шардинге доменов. Это уже устаревшие оптимизации.</p>



<h2><span id="34_Izmenenie_URL-adresa_vhoda_v_adminku_WordPress">34. Изменение URL-адреса входа в админку WordPress</span></h2>



<p>По умолчанию URL входа на сайт WordPress — <em><strong>domain.com/wp-admin/</strong></em>. Одна из проблем заключается в том, что все боты, хакеры и скрипты также знают этот адрес. Изменив URL, вы можете сделать себя менее привлекательной мишенью, лучше защититься от атак методом перебора и уменьшить пропускную способность канала, используемого ботами, которые постоянно обращаются к этому URL.</p>



<p>Изменение URL-адреса входа в WordPress также поможет предотвратить такие распространенные ошибки, как «<em>429 Too Many Requests</em>«. Это не универсальное решение, а всего лишь один маленький трюк, который поможет защитить вас и снизить нагрузку на сайт.</p>



<h2><span id="35_Otklucenie_ili_nastrojka_obnovlenij_plaginov_i_tem">35. Отключение или настройка обновлений плагинов и тем</span></h2>



<p>На медленную работу панели администратора WordPress могут влиять сеть, расположение центра обработки данных и даже версии PHP. Но еще один фактор, о котором мало кто говорит, — это проверка обновлений WordPress, которая работает в фоновом режиме. Это один из случаев, когда наличие большого количества плагинов и тем WordPress может навредить.</p>



<p>По сути, проблема заключается в том, что встроенная программа проверки обновлений WordPress делает внешний <code>GET</code>-запрос в фоновом режиме (<em><strong>https://third-party-plugin/update-check.php</strong></em>). Иногда это может происходить периодически или очень часто. Если это происходит постоянно, это может привести к тому, что ваша панель администратора начнет работать с перебоями.</p>



<p>Это проблема скорее в том, как устроен механизм проверки обновлений в WordPress. Если вы страдаете от медленной загрузки панели администратора WordPress, попробуйте решить эту проблему. Устранение проблемы заключается в отключении автоматических обновлений. </p>



<div class="attention-yellow"><strong>Внимание</strong>! Делайте это только в том случае, если вы собираетесь проверять наличие обновлений вручную. Многие обновления включают в себя исправления безопасности и ошибок.</div>



<h2><span id="36_Ispolzujte_InnoDB_v_MySQL">36. Используйте InnoDB в MySQL</span></h2>



<p>Многие старые сайты до сих пор используют в своей базе данных механизм хранения <strong>MyISAM</strong>. За последние годы <strong>InnoDB</strong> показал себя лучше и надежнее.</p>



<p>Вот несколько преимуществ InnoDB перед MyISAM:</p>



<ul>
<li>InnoDB имеет блокировку на уровне строк. MyISAM имеет только полную блокировку на уровне таблицы. Это позволяет вашим запросам обрабатываться быстрее.</li>



<li>InnoDB имеет так называемую ссылочную целостность, которая включает поддержку внешних ключей (RDBMS) и ограничений отношений, а MyISAM — нет (DMBS).</li>



<li>InnoDB поддерживает транзакции, что означает возможность фиксации и отката. MyISAM этого не делает.</li>



<li>InnoDB более надежна, так как использует транзакционные журналы для автоматического восстановления. MyISAM этого не делает.</li>
</ul>



<h2><span id="37_Ocistite_tablicu_wp_options_i_dannye_avtozagruzki">37. Очистите таблицу wp_options и данные автозагрузки</span></h2>



<p>Таблицу <code>wp_options</code> часто упускают из виду, когда речь заходит об общей производительности WordPress и базы данных. Особенно на старых и больших сайтах, эта таблица может быть виновником медленных запросов на вашем сайте из-за автозагрузки данных, оставленных сторонними плагинами и темами.</p>



<p>Таблица wp_options содержит всевозможные данные для вашего сайта WordPress, такие как:</p>



<ul>
<li>URL сайта, домашний URL, email администратора, категория по умолчанию, посты на странице, формат времени и т.д.</li>



<li>Настройки для плагинов, тем, виджетов</li>



<li>Временно кэшированные данные</li>
</ul>



<p>Эта таблица содержит следующие поля (столбцы):</p>



<ul>
<li>option_id</li>



<li>option_name</li>



<li>option_value</li>



<li><strong>autoload&nbsp;</strong>(именно об этом мы заботимся, когда речь идет о производительности)</li>
</ul>



<p>Одной из важных вещей, которые необходимо понять относительно таблицы wp_options, является поле autoload. Оно содержит значение «да» (<strong>yes</strong>) или «нет» (<strong>no</strong>) (флаг). По сути, оно управляет тем, загружается ли оно функцией <code>wp_load_alloptions()</code> или нет. Данные автозагрузки — это данные, которые загружаются на каждой странице вашего сайта WordPress.</p>



<p>Для разработчиков атрибут автозагрузки по умолчанию установлен на «<strong>yes</strong>«, но не каждый плагин теоретически должен загружать свои данные на каждой странице.</p>



<p>Проблема, с которой могут столкнуться сайты WordPress, возникает тогда, когда в таблице <code>wp_options</code> находится большое количество данных автозагрузки.</p>



<p>Какой объем данных является слишком большим для автозагрузки? Конечно, этот показатель может варьироваться, но в идеале он должен составлять от 300 КБ до 1 МБ. Как только вы начинаете приближаться к диапазону 3-5 МБ и более, скорее всего, есть вещи, которые можно оптимизировать или убрать из автозагрузки. А все, что превышает 10 МБ, должно быть решено немедленно. Это не всегда означает, что это вызовет проблему, но это хорошее начало.</p>



<h2><span id="38_Ocistka_sessij_WordPress">38. Очистка сессий WordPress</span></h2>



<p>Другая распространенная проблема, с которой мы сталкиваемся, заключается в том, что иногда задания <strong>cron</strong> не синхронизируются или не срабатывают должным образом, и поэтому сессии не очищаются. В результате вы можете получить тонны строк <code>wp_session</code> в вашей базе данных. В приведенном ниже примере у сайта в таблице <code>wp_options</code> оказалось более 3 миллионов строк. Размер таблицы превысил 600 МБ.</p>


<div>
<figure><img src="images/wp_options-row.png" alt="" class="img-fluid"></figure></div>


<h2><span id="39_Dobavit_indeks_k_Avtozagruzke">39. Добавить индекс к Автозагрузке</span></h2>



<p>Если очистки таблицы wp_options недостаточно, вы можете попробовать добавить «индекс» к полю автозагрузки. Это, по сути, может помочь более эффективному поиску.</p>



<h2><span id="40_Ispolzovanie_Redis_v_kacestve_postoannogo_kesa_obektov">40. Использование Redis в качестве постоянного кэша объектов</span></h2>



<p>Redis — это хранилище структур данных в памяти с открытым исходным кодом. В контексте WordPress Redis можно использовать для постоянного хранения значений, сгенерированных собственным кешем объектов WordPress, чтобы кешированные объекты можно было повторно использовать между загрузками страниц.</p>



<p>Использование постоянного объектного кеша, такого как Redis, позволяет повторно использовать кэшированные объекты, вместо того, чтобы запрашивать у базы данных MySQL второй запрос для того же объекта. В результате Redis может снизить нагрузку на базу данных MySQL веб-сайта, одновременно уменьшая время отклика сайта и увеличивая его способность масштабироваться и обрабатывать дополнительный трафик.</p>



<h2><span id="41_Ispolzujte_Elasticsearch_dla_uskorenia_poiska_v_WordPress">41. Используйте Elasticsearch для ускорения поиска в WordPress</span></h2>



<p>Elasticsearch — это полнотекстовая поисковая система с открытым исходным кодом. Он используется для индексирования данных и невероятно быстрого поиска по ним.</p>



<p>В контексте WordPress Elasticsearch можно использовать для ускорения запросов к базе данных WordPress. Для этого создается индекс содержимого базы данных вашего сайта, а затем Elasticsearch выполняет поиск по этому индексу намного быстрее, чем запрос MySQL способен выполнить такой же поиск.</p>



<p>Если у вас есть время и возможности, Elasticsearch может быть интегрирован в сайт WordPress высококвалифицированным разработчиком WordPress и Elasticsearch.</p>



<h2><span id="42_Sozdanie_legkoj_stranicy_404">42. Создание легкой страницы 404</span></h2>



<p>Я на собственном опыте убедился, что высокодинамичные сайты обычно генерируют большое количество ошибок 404.</p>



<p>Причина этих ошибок в том, что многие страницы 404 очень ресурсоемки. Для высокодинамичного сайта WordPress лучше избегать тяжелых страниц 404.</p>



<p>Создайте простой шаблон 404, который по возможности избегает дальнейших запросов к базе данных. И, конечно же, потратьте немного времени и исправьте ошибки 404, поскольку это не только требует значительных ресурсов, но и плохо сказывается на пользовательском опыте.</p>



<p>Помимо использования легкой страницы 404, я также рекомендую внедрить специальное правило кэширования для 404 страницы.</p>



<h2><span id="43_Minimizacia_redirektov">43. Минимизация редиректов</span></h2>



<p>Минимизируйте перенаправления (редиректы) и добавляйте их на уровне сервера. Слишком большое количество перенаправлений — это то, чего всегда нужно остерегаться. Простые перенаправления, такие как одно 301 перенаправление, HTTP на HTTPS, или www на не-www (и наоборот) — это нормально.</p>



<p>И во многих случаях они необходимы в определенных областях вашего сайта. Однако каждый из них влияет на производительность вашего сайта. И если вы начинаете нагромождать перенаправления друг на друга, важно понимать, как они влияют на ваш сайт. Это относится к перенаправлениям страниц и постов, перенаправлениям изображений — ко всему.</p>



<p>Перенаправление генерирует 301 или 302 в статусе заголовка ответа.</p>



<h2><span id="44_Dobavlenie_zagolovka_Cache-Control">44. Добавление заголовка Cache-Control</span></h2>



<p>Добавление в <strong>Nginx</strong></p>



<p>Вы можете добавить заголовки <code>cache-control</code> в Nginx, добавив следующее в конфигураторе сервера.</p>



<pre><code class="language-bash">location ~* \.(js|css|png|jpg|jpeg|gif|svg|ico)$ {
 expires 30d;
 add_header Cache-Control "public, no-transform";
}</code></pre>



<p>Добавление в <strong>Apache</strong></p>



<p>Вы можете добавить заголовки <code>cache-control</code> в Apache, добавив следующее в ваш файл <strong><em>.htaccess</em></strong>. Фрагменты кода можно добавить в верхней или нижней части файла (до <code># BEGIN WordPress</code> или после <code># END WordPress</code>).</p>



<pre><code class="language-php">&lt;filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|svg|js|css|swf)$"&gt;
Header set Cache-Control "max-age=84600, public"
&lt;/filesMatch&gt;</code></pre>



<h2><span id="45_Dobavlenie_zagolovka_Expires">45. Добавление заголовка Expires</span></h2>



<p>Добавление в <strong>Nginx</strong></p>



<p>Вы можете добавить заголовки <code>expires</code> в Nginx, добавив следующее в конфигурацию. В этом примере показано, как указать разное время истечения срока действия в зависимости от типа файла.</p>



<pre><code class="language-php">location ~*  \.(jpg|jpeg|gif|png|svg)$ {
        expires 365d;
    }

    location ~*  \.(pdf|css|html|js|swf)$ {
        expires 2d;
    }</code></pre>



<p>Добавление в <strong>Apache</strong></p>



<p>Вы можете добавить заголовки <code>expires</code> в Apache, добавив следующее в ваш файл <strong><em>.htaccess</em></strong>.</p>



<pre><code class="language-php">## EXPIRES HEADER CACHING ##
&lt;IfModule mod_expires.c&gt;
ExpiresActive On
ExpiresByType image/jpg "access 1 year"
ExpiresByType image/jpeg "access 1 year"
ExpiresByType image/gif "access 1 year"
ExpiresByType image/png "access 1 year"
ExpiresByType image/svg "access 1 year"
ExpiresByType text/css "access 1 month"
ExpiresByType application/pdf "access 1 month"
ExpiresByType application/javascript "access 1 month"
ExpiresByType application/x-javascript "access 1 month"
ExpiresByType application/x-shockwave-flash "access 1 month"
ExpiresByType image/x-icon "access 1 year"
ExpiresDefault "access 2 days"
&lt;/IfModule&gt;
## EXPIRES HEADER CACHING ##</code></pre>



<h2><span id="46_Dobavlenie_zagolovkov_Last-Modified_i_ETag">46. Добавление заголовков Last-Modified и ETag</span></h2>



<p>Далее у нас есть еще два набора заголовков, <code>last-modified</code> и <code>etag</code>.</p>



<p>Заголовки <code>cache-control</code> и expires помогают браузеру определить, изменился ли файл с момента последнего запроса (точнее, они проверяют кэш). Заголовки <code>last-modified</code> и <code>etag</code> подтверждают и устанавливают длину кэша и должны быть включены в каждый ответ оригинального сервера. Если они не установлены должным образом, вы можете увидеть предупреждение о необходимости «<em>Указать валидатор кэша</em>«.</p>



<p>Вы можете включить заголовок <code>ETag</code> вручную в Nginx, используя следующий код.</p>



<pre><code class="language-php">etag on</code></pre>

<h2><span id="47_Izmenenie_limita_pamati_WordPress_v_wp-configphp">47. Изменение лимита памяти WordPress в wp-config.php</span></h2>


<p>Как указано в WordPress Codex, в WordPress версии 2.5 опция WP_MEMORY_LIMIT позволяет указать максимальный объем памяти, который может потреблять PHP. Эта настройка может понадобиться в том случае, если вы получите сообщение типа «Разрешенный объем памяти xxxxxx байт исчерпан» (Allowed memory size of xxxxxx bytes exhausted).</p>



<p>По умолчанию WordPress будет пытаться увеличить память, выделяемую PHP, до 40 МБ для одного сайта и 64 МБ для нескольких сайтов. Ограничения памяти определяются в файле <em><strong>./wp-includes/default-constants.php</strong></em>, в строках 32 — 44.</p>



<p>У вас также есть ограничение PHP memory_limit на сервере, установленное вашим хостинг-провайдером. Это две разные вещи. Если вы столкнулись с ошибкой «Объем памяти исчерпан», вы можете попробовать увеличить лимит памяти PHP в WordPress.</p>



<p>Добавьте следующее в ваш файл wp-config.php, прямо перед строкой, в которой говорится «Это все, прекратите редактирование! Счастливого блоггинга» (That’s all, stop editing! Happy blogging.).</p>



<pre><code class="language-php">define( 'WP_MEMORY_LIMIT', '256M' );</code></pre>



<p>Вместо того чтобы задавать объем вручную, вы можете установить его на значение PHP <code>memory_limit</code>.</p>



<pre><code class="language-php">define( 'WP_MEMORY_LIMIT', ini_get( 'memory_limit' ) );</code></pre>



<h2><span id="48_Otklucenie_Emojis_v_WordPress">48. Отключение Emojis в WordPress</span></h2>



<p>Существует несколько различных способов отключить Emojis в WordPress. Вы можете сделать это с помощью бесплатного плагина или с помощью кода.</p>



<h2><span id="49_Otklucenie_RSS-kanalov_WordPress">49. Отключение RSS-каналов WordPress</span></h2>



<p>Если вы не используете блоговую часть WordPress на своем сайте, вы можете отключить RSS-каналы WordPress. Хотя это и не окажет большого влияния на производительность, все же помогает. Кроме того, это еще одна вещь, о которой вам все-равно придется беспокоиться.</p>



<h2><span id="49_Ispolzujte_Prefetch_i_Preconnect">49. Используйте Prefetch и Preconnect</span></h2>



<p>Подсказки ресурсов и директивы, такие как prefetch и preconnect, могут стать отличным способом ускорить работу WordPress в фоновом режиме.</p>



<p><strong>Prefetch</strong></p>



<p>DNS prefetch позволяет вам разрешать доменные имена (выполнять поиск DNS в фоновом режиме) до того, как пользователь нажмет на ссылку, что, в свою очередь, может повысить производительность. Это делается путем добавления тега <code>rel="dns-prefetch"</code> в заголовок вашего сайта WordPress.</p>



<pre><code class="language-html">&lt;link rel="dns-prefetch" href="//domain.com"&gt;</code></pre>



<p>Обычно предварительная выборка DNS используется для URL CDN, шрифтов Google, Google Analytics и т.д.</p>



<pre><code class="language-html">&lt;link rel="dns-prefetch" href="//cdn.domain.com/"&gt;
&lt;link rel="dns-prefetch" href="//fonts.googleapis.com/"&gt;
&lt;link rel="dns-prefetch" href="//www.google-analytics.com"&gt;</code></pre>



<p>Или вы можете легко реализовать DNS prefetch с помощью плагина.</p>



<p><strong>Preconnect</strong></p>



<p>Preconnect позволяет браузеру устанавливать ранние соединения до HTTP-запроса, устраняя задержки при обходе и экономя время пользователей.</p>



<p>Это делается путем добавления тега <code>rel="preconnect"</code> в заголовок вашего сайта WordPress.</p>



<pre><code class="language-html">&lt;link rel="preconnect" href="//domain.com"&gt;</code></pre>



<p>Несколько примеров того, что вы можете захотеть использовать для этого: URL CDN или Google Fonts.</p>



<pre><code class="language-html">&lt;link rel="preconnect" href="https://cdn.domain.com"&gt;
&lt;link rel="preconnect" href="https://fonts.gstatic.com"&gt;</code></pre>



<h2><span id="50_Ubedites_cto_vas_sajt_adaptiven">50. Убедитесь, что ваш сайт адаптивен</span></h2>



<p>Ваш сайт должен быть адаптивным! Это означает, что он использует медиа-запросы для автоматического уменьшения масштаба на мобильных устройствах. Если вы до сих пор не сделали этого, то, скорее всего, вы уже отстали от своих конкурентов.</p>



<p>Используйте инструмент Google Mobile-Friendy для тестирования и убедитесь, что ваш сайт соответствует всем требованиям.</p>



<h2><span id="51_Ocistite_svou_mediateku">51. Очистите свою медиатеку</span></h2>



<p>Со временем у вас могут начать накапливаться изображения, которые больше не используются. Чтобы освободить место, следует подумать об удалении неиспользуемых медиафайлов.</p>



<p>Чтобы удалить неиспользуемые медиафайлы вручную, вы можете использовать плагин, например Media Cleaner, чтобы избавиться от неиспользуемых медиафайлов, или сделать это вручную. Чтобы вручную удалить неиспользуемые медиафайлы, просто перейдите в меню <strong>Добавить медиа</strong> -&gt; <strong>Медиатека</strong> -&gt; <strong>Неприкрепленные</strong> (Add Media -&gt; Media Library -&gt; Unattached), а затем удалите файлы, которые больше не используются.</p>



<h2><span id="52_Kolicestvo_statej_na_stranice_v_arhivah">52. Количество статей на странице в архивах</span></h2>



<p>Рекомендуется в архивах, т.е. на страницах категорий, выводить не более 5 постов. Более 8 постов могут привести к большому количеству обращений к Базе данных.</p>



<p>Самое оптимальное количество статей в архивах не более 5.</p>



<h2><span id="53_Pravilnyj_robotstxt">53. Правильный robots.txt</span></h2>



<p>Очень больная тема для любого специалиста, связанного с SEO — правильная индексация сайт поисковыми системами. Постоянно в индекс залетает большое количество ненужных страниц, даже если вы запрещаете что-то в robots.txt.</p>



<p>Для своего файла robots.txt я взял за основу рекомендации wp-kama и дополнил их некоторыми своими директивами.</p>



<p>Мой <strong>robots.txt</strong>:</p>



<pre><code class="language-bash">User-agent: *
Disallow: /cgi-bin
Disallow: /wp-admin/
Disallow: /wp/
Disallow: /?
Disallow: *?s=
Disallow: *&amp;s=
Disallow: /search
Disallow: /author/
Disallow: */embed
Disallow: */page/
Disallow: */xmlrpc.php
Disallow: *utm*=
Disallow: *openstat=
Disallow: /*.pdf$
Disallow: /*.doc$
Disallow: /*.docs$
Disallow: /*.xls$
Disallow: */wp-*/*.pdf
Disallow: /wp-
Allow:    */wp-*/*ajax*.php
Allow:    */wp-sitemap
Allow:    */uploads
Allow:    */wp-*/*.js
Allow:    */wp-*/*.css
Allow:    */wp-*/*.png
Allow:    */wp-*/*.jpg
Allow:    */wp-*/*.jpeg
Allow:    */wp-*/*.gif
Allow:    */wp-*/*.svg
Allow:    */wp-*/*.webp

Host: https://site.ru
Sitemap: https://site.ru/sitemap_index.xml</code></pre>



<p>Основной проблемой до недавнего времени было наличие в индексе большого количества файлов из wp-content, которые не нужны в индексе поисковиков.</p>



<p>Недавно поменял директивы на всех своих сайтах по аналогии с тем, что привел выше. Буду наблюдать за ситуацией и за тем как быстро из индекса удалятся ненужные файлы и папки.</p>



<p>Опыт подсказывает, что у качественных проектов количество страниц в индексе Google и Yandex должно совпадать или быть очень близким.</p>



<h2><span id="54_Ubiraem_stili_Elementor">54. Убираем стили Elementor</span></h2>



<p>Убираем стили Elementor в Dom страницы сайта.</p>



<p>Небольшая заметка о том, как убрать инлайн-стили в dom сайта на WordPress, которые вставляет плагин Elementor. Перейдите в: </p>



<p><em>Elementor -&gt; Настройки -&gt; Эксперименты</em> (<strong>Elementor</strong> &gt; <strong>Settings</strong> &gt; <strong>Experiments</strong>)</p>



<p>В разделе «Текущие эксперименты» (<strong>Ongoing Experiments</strong>) отключите (установите неактивным) «Улучшенная загрузка CSS» (<strong>Improved CSS Loading</strong>).</p>



<h2><span id="55_Ubiraem_nazvanie_stati_iz_hlebnyh_krosek_Yoast">55. Убираем название статьи из хлебных крошек Yoast</span></h2>



<p>Убираем название статьи из хлебных крошек Yoast SEO. Для нашей оптимизации лишние дублирование информации может негативно влиять на продвижение сайтов.</p>



<pre><code class="language-php">function adjust_single_breadcrumb( $link_output) {
	if(strpos( $link_output, 'breadcrumb_last' ) !== false ) {
		$link_output = '';
	}
   	return $link_output;
}
add_filter('wpseo_breadcrumb_single_link', 'adjust_single_breadcrumb' );</code></pre>



<p>Что удивительно для новичков — это то, что сниппеты WordPress позволяют менять некоторую функциональность сторонних плагинов, как в данном примере с плагином Yoast.</p>



<h2><span id="56_Ubiraem_category">56. Убираем category</span></h2>



<p>На некоторых сайтах WordPress есть необходимость убрать слово <em><strong>category</strong></em> из адреса страницы архивов или записей, разберемся как это проще сделать.</p>



<p>Часто адрес категории отображается в URL как-то так:</p>



<pre><code class="language-bash">www.yourdomain.com/category/your-category-name</code></pre>



<p>Нам нужно убрать слово <em><strong>category</strong></em> из URL WordPress без ущерба для функциональности сайта. Разберем четыре метода удаления категории из URL WordPress.</p>



<h3><span id="Sposob_1_cerez_nastrojki_WordPress">Способ 1: через настройки WordPress</span></h3>



<p>1. Войдите в админку WordPress</p>



<p>2. Перейдите в <strong>Setting</strong>&nbsp;-&gt;&nbsp;<strong>Permalink&nbsp;</strong>(Настройки -&gt; Постоянные ссылки)</p>



<p>3. Выберите <strong>Custom Structure</strong> (Произвольно)&nbsp;и вставьте в это поле<strong>&nbsp;</strong><code>/%category%/%postname%/</code></p>



<p>4. В поле <strong>Category base</strong> (Префикс для рубрик), поместите точку:&nbsp;<strong>(.)</strong> — см. скриншот ниже</p>



<p>5. Сохраните изменения</p>



<div class="attention-blue"><strong>Важно</strong>! Пункты 3 и 4 работают только вместе, если вы не хотите получать на сайте 404 ошибки.</div>



<p>Наглядно так:</p>


<div>
<figure><img src="images/category-wordpress-001.png" alt="" class="img-fluid"></figure></div>


<p>Еще раз повторю, вы должны убедиться в двух вещах, что <code>/%category%/%postname%/</code> указано в в поле <strong>Произвольно</strong> и точка поставлена в <strong>Префиксе для рубрик</strong>.</p>



<p>Процедура не будет работать полноценно, пока вы не поставите точку <strong>(.)</strong>. Перейдите на страницы разных категорий на вашем сайте после сохранения настроек, чтобы увидеть изменения. Вы увидите, что ваш URL не содержит теперь слово <strong><em>category</em></strong>. Не забудьте сбросить кэш, если это необходимо.</p>



<h3><span id="Sposob_2_s_pomosu_otdelnogo_plagina">Способ 2: с помощью отдельного плагина</span></h3>



<p>Также <strong>category</strong> мы можем убрать с помощью плагинов. Для этого вам потребуется установить плагин подобный «Remove Category URL».</p>


<div>
<figure><img src="images/category-wordpress-002.png" alt="" class="img-fluid"></figure></div>


<p>Это простой плагин и вам не нужно ничего делать, чтобы удалить category из URL, кроме того, что только активировать плагин в админке. Этот плагин удалит слаг из вашего URL автоматически. Он также совместим с другим плагином — WPML. Так что если вы используете WPML, вам не придется беспокоиться об этом.</p>



<h3><span id="Sposob_3_s_pomosu_plagina_Yoast_SEO_ili_Rank_Math_SEO">Способ 3: с помощью плагина Yoast SEO или Rank Math SEO</span></h3>



<p>Yoast SEO считается самым популярным плагином, который помогает SEO оптимизировать сайт. Он оптимизирует записи в блоге, помогает в исследовании ключевых слов, оптимизации страниц и многом другом.</p>



<p>Правда, я от него отказался. Его влияние переоценено и он ест много ресурсов на мой субъективный взгляд. Увеличивает прилично количество обращений к БД и плохо сделать с точки зрения сохранения данных и их вывода на сайт. </p>



<p>Но да, плагин Yoest SEO тоже может помочь удалить category из урла вашего сайта.</p>



<ol>
<li>Перейдите в&nbsp;<strong>Yoast SEO</strong></li>



<li>Далее в&nbsp;<strong>Search Appearance&nbsp;</strong></li>



<li>Прокрутите вниз и отметьте чекбокс <strong>Remove the&nbsp;categories prefix</strong>&nbsp;(убрать префикс категорий)</li>



<li>Нажмите <strong>Save</strong> (Сохранит</li>
</ol>


<div>
<figure><img src="images/category-wordpress-003.png" alt="" class="img-fluid"></figure></div>


<p>После выполнения всех шагов слово <strong><em>category</em></strong> будет удалено из URL. Больше ничего не нужно делать.</p>



<p>В настройках плагина Rank Math SEO также есть опция удаления категории из адреса архивов или статей.</p>



<h3><span id="Sposob_4_s_pomosu_htaccess">Способ 4: с помощью .htaccess</span></h3>



<p>Используя файл <em><strong>.htaccess</strong></em> мы также можем удалить категорию из URL-адресов. Это ручной процесс, который можно выполнить через самостоятельную редакцию этого файла.</p>



<p>Но если вы вообще далеки от программирования, кода, разработки, то лучше самому никакие правки никуда не вносить, чтобы не навредить вашему сайту.</p>



<p>Нам в <strong><em>.htaccess </em></strong>нужно внести одну строку:</p>



<pre><code class="language-bash">RewriteRule ^category/(.+)$ http://www.yourdomain.com/$1 [R=301,L]</code></pre>



<p>Остается только скопировать и вставить код в файл <strong><em>.htaccess</em></strong> и заменить <code>yourdomain.com</code> на домен вашего сайта. После этого <strong>category</strong> больше не будет отображаться в вашем URL.</p>



<p>Вы можете использовать любой из способов, указанных выше. Но надо понимать, что использование плагинов не всегда рекомендуется из-за того, что они иногда используют много ресурсов хостинга и могут, например, перестать поддерживать актуальную версию WordPress. </p>



<p>Если вы используете плагин <strong>Yoast SEO</strong>, то скорее всего для вас это лучший способ решения этой задачи. Плагин часто обновляется, за ним следят и поддерживают новые выпуски WordPress. </p>



<p>На своих проектах в большинстве случаев я слово <strong><em>category</em></strong> не убираю из URL, ничего страшного в такой структуре адреса я не вижу.</p>



<h2><span id="57_Apdejt_jQuery">57. Апдейт jQuery</span></h2>



<p>Если провести аудит в Chrome Developer Tools для WordPress, начиная с версии 4.9.8, то Google сообщит, что на сайте по-умолчанию используется jQuery версия 1.12.4, которая содержит две известных уязвимости безопасности.</p>



<p>Использование данной устаревшей версии jQuery уменьшает баллы, полученные сайтом в Lighthouse. И это не есть хорошо.</p>



<p>Удивительно, что WordPress использует старый jQuery в ядре. Вероятно, создатели CMS думают об обратной совместимости. Многие темы и плагины сделаны были еще с учетом старой версии jQuery, а 3.x и, вероятно, 2.x, ломают темы и плагины.</p>



<div class="attention-yellow"><strong>Внимание</strong>! Вы не должны заменять основную версию jQuery, особенно в панели администрирования. Так как многие функции ядра WordPress могут зависеть от этой версии. Также, другие плагины могут зависеть от версии jQuery, добавленной в ядро.</div>



<p>Если вы уверены, что хотите изменить версию ядра jQuery, то в этом случае вы можете добавить следующий код в файл <strong>functions.php</strong> вашей активной темы (еще лучше, если вы создадите для этого плагин):</p>



<pre><code class="language-php">function replace_core_jquery_version() {
    wp_deregister_script( 'jquery' );
    // Измените URL, если вы хотите загрузить локальную копию jQuery с вашего собственного сервера
    wp_register_script( 'jquery', "https://code.jquery.com/jquery-3.1.1.min.js", array(), '3.1.1' );
}
add_action( 'wp_enqueue_scripts', 'replace_core_jquery_version' );</code></pre>



<p>Код выше заменит основную версию jQuery и вместо этого загрузит версию <strong>3.1.1</strong> с сервера Google.</p>



<p>Также, хотя это и не рекомендуется, для замены версии jQuery в <strong>wp-admin</strong> можно использовать следующую дополнительную строку кода:</p>



<pre><code class="language-php">add_action( 'admin_enqueue_scripts', 'replace_core_jquery_version' );</code></pre>



<p>Для админки использование старой версии, в целом, не принципиально, т.к. на баллы Аудита это никак не сказывается.</p>



<p>Таким образом, даже после обновления WordPress, у вас будет версия jQuery, которую вы захотите.</p>



<p>Можно еще кое-что сделать.</p>



<p>Функция <code>replace_core_jquery_version</code> выше также удаляет <code>jquery-migrate</code> скрипт, добавленный ядром WordPress.</p>



<p>Это разумно, так как новейшая версия jQuery не будет корректно работать со старой версией <code>jquery-migrate</code>. Однако вы можете включить и более новую версию <code>jquery-migrate</code>. В этом случае используйте следующую функцию:</p>



<pre><code class="language-php">function replace_core_jquery_version() {
    wp_deregister_script( 'jquery-core' );
    wp_register_script( 'jquery-core', "https://code.jquery.com/jquery-3.1.1.min.js", array(), '3.1.1' );
    wp_deregister_script( 'jquery-migrate' );
    wp_register_script( 'jquery-migrate', "https://code.jquery.com/jquery-migrate-3.0.0.min.js", array(), '3.0.0' );
}</code></pre>



<p>Но стоит сказать, что в новых версиях WP обновлена версия jQuery и в этом шаге может не быть необходимости.</p>



<h2><span id="58_Sozdanie_Facebook_App_ID_dla_Yoast_SEO">58. Создание Facebook App ID для Yoast SEO</span></h2>



<p>Рассмотрим как создать ID для приложения Facebook, которое мы потом будем вставлять в поле плагина Yoast SEO.</p>



<p>Переходим на сайт Facebook Developers и нажимаем на зеленую кнопку «<strong>Register now</strong>» (рус. — Зарегистрироваться сейчас), чтобы зарегистрироваться в качестве Разработчика для создания нового приложения.</p>


<div>
<figure><img src="images/facebook-id-1.jpg" alt="" class="img-fluid"></figure></div>


<p>Нажмите <strong>next</strong> (рус. — далее):</p>


<div>
<figure><img src="images/facebook-id-2.jpg" alt="" class="img-fluid"></figure></div>


<p>Выберите <strong>Developer</strong>, когда Вас спросят, что из нижеследующего лучше всего Вас описывает.</p>


<div>
<figure><img src="images/facebook-id-3.jpg" alt="" class="img-fluid"></figure></div>


<p>Нажмите кнопку <strong>Create First App</strong>:</p>


<div>
<figure><img src="images/facebook-id-4.jpg" alt="" class="img-fluid"></figure></div>


<p>Введите отображаемое имя (<strong>Display Name</strong>) и контактную электронную почту (<strong>Contact Email</strong>), затем нажмите кнопку <strong>Create App ID</strong> (Создать ID приложения):</p>


<div>
<figure><img src="images/facebook-id-5.jpg" alt="" class="img-fluid"></figure></div>


<p>Заполните Google Security Captcha:</p>


<div>
<figure><img src="images/facebook-id-6.jpg" alt="" class="img-fluid"></figure></div>


<p>Перейдите в раздел «Основные настройки» (<strong>Basic Settings</strong>). Далее заполните основные данные. После этого вы сможете активировать ваше приложение (live).</p>


<div>
<figure><img src="images/facebook-id-7.jpg" alt="" class="img-fluid"></figure></div>


<p>Добавить веб-сайт как <strong>Platform</strong> (рус. — платформа):</p>


<div>
<figure><img src="images/facebook-id-8.jpg" alt="" class="img-fluid"></figure></div>


<p>На данном этапе вы создали свое приложение для Facebook и получили нужный нам ID. Пришло время интегрировать ваш сайт с вашим новым приложением для Facebook.</p>



<p>Если вы используете Yoast SEO плагин на вашем собственном сайте WordPress, то на сайте в админке переходим в:</p>



<p><strong>Yoast SEO -&gt; Social -&gt; Facebook</strong></p>



<p>Во вкладке Facebook вставляем наш ID приложения и жмем <strong>Сохранить</strong> (англ. — save):</p>


<div>
<figure><img src="images/facebook-id-9.jpg" alt="" class="img-fluid"></figure></div>


<p>Кстати, на этом шаге будет исправлена ошибка «отсутствуют следующие необходимые свойства: fb:app_id» (the following required properties are missing: fb:app_id) в отладчике URL facebook. </p>



<p>Отвечу ниже на некоторые возникшие вопросы.</p>



<p><strong>Каковы преимущества интеграции идентификатора приложения Facebook с плагином Yoast SEO?</strong></p>



<p>— Лучшая видимость в социальной сети Facebook.</p>



<p><strong>Могу ли я назначить идентификатор приложения для кнопки Jetpack Share?</strong></p>



<p>— Если вы используете кнопку расшаривания JetPack, то вы должны назначить свой собственный идентификатор приложения.</p>



<p><strong>Стоит ли Facebook денег за создание APP ID?</strong></p>



<p>— Нет, это совершенно бесплатно.</p>



<p>Ускорение и оптимизация WordPress почти завершены. Еще раз повторю — не стоит применять все методы одновременно, зачастую один бесплатный плагин может решить большинство проблем.</p>
			
		</div>
	</div>
</div>
<div class="container">
	<div class="row">
		<div class="col-12 col-md-7">
			<div class="mb-3 mb-mb-4 d-flex gap-3">
				<div>
					<img alt="Сергей Ермилов" src="../../assets/images/sergei-450.png" height="68" width="68">
				</span>
				</div>
				<div>
					<a href="../../about/" class="link-dark link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">Сергей Ермилов</a><br>
					<span>Дизайнер, верстальщик, фронтенд-разработчик, PHP и WordPress энтузиаст, главный редактор сайта</span>
				</div>
			</div> 
		</div>
		<div class="col-12 col-md-5">
			<span class="text-muted">Опубликовано 13 октября 2021 в 18:52</span><br>Теги: WordPress
		</div>
	</div>
</div>

<!-- ------------ -->
<!-- START FOOTER -->
<!-- ------------ -->
<footer class="py-5">
	<div class="container">
		<div class="row">
			<div class="col-12 col-md-4 my-auto">
				<span class="fw-500 text-muted">SergeiErmilov</span>
			</div>
			<div class="col-12 col-md-4 text-center my-auto">
				<img src="../../assets/images/sergei-150.png" alt="Sergei Ermilov" width="80" height="80">
			</div>
			<div class="col-12 col-md-4 my-auto text-end">
				<span class="fw-500 text-muted">&copy; 2008-<script>document.write(new Date().getFullYear())</script></span>
			</div>
		</div>
	</div>
</footer>

	<script src="../../assets/js/bootstrap.bundle.min.js"></script>
	<script src="../../assets/js/app.js"></script>
	<script src="../../assets/js/prism.js"></script>	

  </body>
</html>